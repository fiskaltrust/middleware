## ActionJournal Types

| market | type                                         | message                                                                                                                                                                                                                                   |
|--------|----------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| AT     | `4154000000000003-FonActivateQueue`          | `Aktivierung (Inbetriebnahme) einer Sicherheitseinrichtung {queue.ftQueueId} nach RKSV. (Queue)`                                                                                                                                          |
| AT     | `4154000000000003-FonDeactivateQueue`        | `De-Aktivierung (Ausserbetriebnahme) einer Sicherheitseinrichtung {queue.ftQueueId} nach RKSV. (Queue)`                                                                                                                                   |
| AT     | `4154000000000003-FonVerifySignature`        | `Prüfen der Signatur {fonVerifySignature.DEPValue} mittels FON.`                                                                                                                                                                          |
| DE     | `null`                                       | `QueueItem {queueItem.ftQueueItemId} enabled mode \"UsedFailed\" of Queue {queueAT.ftQueueATId}`                                                                                                                                          |
| DE     | `4445000020000000-OpenTransaction`           | `Removed open transaction {openTransaction.TransactionNumber} from the database, which was not open on the TSE anymore.`                                                                                                                  |
| DE     | `null`                                       | `QueueId {queueItem.ftQueueId} was not activated or already deactivated`                                                                                                                                                                  |
| DE     | `null`                                       | `SCU switching process initiated, but not yet finished.`                                                                                                                                                                                  |
| DE     | `4445000000000003-FinishSCUSwitch`           | `SCU mit Queue verbunden. Kassenseriennummer: {clientId}, TSE-Seriennummer: {serialnumberOctet}, Queue-ID: {queue.ftQueueId}, SCU-ID: {initiateSwitchNotification.TargetSCUId}`                                                           |
| DE     | `4445000000000003-InitiateSCUSwitch`         | `SCU von Queue getrennt. Kassenseriennummer: {queueDE.CashBoxIdentification}, TSE-Seriennummer: {serialnumberOctet}, Queue-ID: {queue.ftQueueId}, SCU-ID: {sourceScu.ftSignaturCreationUnitDEId}`                                         |
| DE     | `null`                                       | `Queue {queue.ftQueueId} is activated, initial-operations-receipt can not be executed.`                                                                                                                                                   |
| DE     | `null`                                       | `Queue {queue.ftQueueId} is de-activated, initial-operations-receipt can not be executed.`                                                                                                                                                |
| DE     | `4445000000000003-ActivateQueueSCU`          | `In-Betriebnahme-Beleg. Kassenseriennummer: {clientId}, TSE-Seriennummer: {serialnumberOctet}, Queue-ID: {queue.ftQueueId}`                                                                                                               |
| DE     | `4445000000000004-DeactivateQueueSCU`        | `Außer-Betriebnahme-Beleg. Kassenseriennummer: {queueDE.CashBoxIdentification}, {(serialnumberOctet != null ? $"TSE-Seriennummer: {serialnumberOctet}, " : "")}Queue-ID: {queue.ftQueueId}`                                               |
| DE     | `4445000008000007`                           | `Daily-closing receipt was processed, and a master data update was performed. However TSE was not reachable.`                                                                                                                             |
| DE     | `4445000000000007`                           | `Daily-closing receipt was processed. However TSE was not reachable.`                                                                                                                                                                     |
| DE     | `4445000008000007`                           | `Monthly-closing receipt was processed, and a master data update was performed. However TSE was not reachable.`                                                                                                                           |
| DE     | `4445000000000007`                           | `Monthly-closing receipt was processed. However TSE was not reachable.`                                                                                                                                                                   |
| DE     | `4445000008000007`                           | `Yearly-closing receipt was processed, and a master data update was performed. However TSE was not reachable.`                                                                                                                            |
| DE     | `4445000000000007`                           | `Yearly-closing receipt was processed. However TSE was not reachable.`                                                                                                                                                                    |
| DE     | `4445000020000000-OpenTransaction`           | `Removed failed finish-transaction {finishTransaction.TransactionNumber} from the database, which was not open on the TSE anymore.`                                                                                                       |
| DE     | `4445000000000002-String`                    | `TSE Kommunikation wiederhergestellt am {DateTime.UtcNow:G}.{queueDE.SSCDFailCount} Aktionen ohne TSE Kommunikation im Zeitraum von {queueDE?.SSCDFailMoment:G} bis {DateTime.UtcNow:G}`                                                  |
| DE     | `4445000000000002-String`                    | `Ausfallsnacherfassung abgeschlossen am {DateTime.UtcNow:G}.{queueDE.UsedFailedCount} Aktionen im Zeitraum von {queueDE.UsedFailedMomentMin:G} bis {queueDE.UsedFailedMomentMax:G}`                                                       |
| IT     | `null`                                       | `QueueId {queueItem.ftQueueId} has not been activated yet.`                                                                                                                                                                               |
| IT     | `null`                                       | `QueueId {queueItem.ftQueueId} has been disabled.`                                                                                                                                                                                        |
| ME     | `4D45000000000007`                           | `Cash-deposit receipt was processed.`                                                                                                                                                                                                     |
| ME     | `4D45000000000008`                           | `Cash-withdrawal receipt was processed.`                                                                                                                                                                                                  |
| ME     | `null`                      Z                | `Queue {queue.ftQueueId} is de-activated, initial-operations-receipt can not be executed.`                                                                                                                                                |
| ME     | `null`                                       | `Queue {queue.ftQueueId} is already activated, initial-operations-receipt can not be executed.`                                                                                                                                           |
| ME     | `4D45000000000005`                           | `Monthly-closing receipt was processed.`                                                                                                                                                                                                  |
| ME     | `4D45000000000006`                           | `Yearly-closing receipt was processed.`                                                                                                                                                                                                   |
| ME     | `4D45000000000002-String`                    | `Restored connection to fiscalization service at {DateTime.UtcNow:G}.{queueME.SSCDFailCount} receipts from the timeframe between {queueME.SSCDFailMoment:G} and {DateTime.UtcNow:G} have been re-processed at the fiscalization service.` |
| ME     | `Configuration`                              | `Configuration`                                                                                                                                                                                                                           |
| *      | `null`                                       | `Queue {_queueId} found cbReceiptReference \"{foundQueueItem.cbReceiptReference}\"`                                                                                                                                                       |
| *      | `null`                                       | `Queue {_queueId} problem on receitrequest`                                                                                                                                                                                               |
| *      | `xxxx2000EEEEEEEE`                           | `An error occurred during receipt processing, resulting in ftState = 0xEEEE_EEEE.`                                                                                                                                                        |
| AT     | `null`                                       | `Queue {queue.ftQueueId} is already activated, initial-operations-receipt cannot be executed.`                                                                                                                                            |
| AT     | `null`                                       | `Tried to activate {queue.ftQueueId}, but the incoming receipt is not a zero receipt.`                                                                                                                                                    |
| AT     | `null`                                       | `QueueItem {queueItem.ftQueueItemId} used to activate Queue {queueAT.ftQueueATId}.`                                                                                                                                                       |
| AT     | `null`                                       | `Initial operation receipt: Generated a new encryption key for {queueAT.CashBoxIdentification}.`                                                                                                                                          |
| AT     | `null`                                       | `Initial operation receipt: Read encryption key for {queueAT.CashBoxIdentification} from configuration.`                                                                                                                                  |
| AT     | `null`                                       | `Initial operation receipt failed: The specified encryption key for {queueAT.CashBoxIdentification} cannot be used.`                                                                                                                      |
| AT     | `null`                                       | `Initial operation receipt: Set LastSignature to \"{queueAT.LastSignatureHash}\" and LastSettlementMoment to \"{queueAT.LastSettlementMoment}\".`                                                                                         |
| AT     | `null`                                       | `Initial operation receipt failed: Could not sign start receipt.`                                                                                                                                                                         |
| AT     | `null`                                       | `Tried to create a monthly receipt for {queue.ftQueueId}, but the incoming receipt is not a zero receipt.`                                                                                                                                |
| AT     | `null`                                       | `Monthly receipt #{queueAT.LastSettlementMonth} of Queue {queue.ftQueueId}. Turnover-Counter: {queueAT.ftCashTotalizer}`                                                                                                                  |
| AT     | `null`                                       | `Monthly receipt failed: Could not sign receipt.`                                                                                                                                                                                         |
| AT     | `null`                                       | `Tried to deactivate {queue.ftQueueId}, but the incoming receipt is not a zero receipt.`                                                                                                                                                  |
| AT     | `null`                                       | `QueueItem {queueItem.ftQueueItemId} used to activate Queue {queueAT.ftQueueATId}.`                                                                                                                                                       |
| AT     | `null`                                       | `Out of operation receipt failed: Could not sign stop receipt.`                                                                                                                                                                           |
| AT     | `null`                                       | `Tried to create a yearly receipt for {queue.ftQueueId}, but the incoming receipt is not a zero receipt.`                                                                                                                                 |
| AT     | `null`                                       | `Annual receipt of Queue {queue.ftQueueId}. Turnover-Counter: {queueAT.ftCashTotalizer}`                                                                                                                                                  |
| AT     | `null`                                       | `Yearly receipt failed: Could not sign receipt.`                                                                                                                                                                                          |
| AT     | `null`                                       | `QueueItem {queueItem.ftQueueItemId} requests zero receipt of Queue {queueAT.ftQueueATId}`                                                                                                                                                |
| AT     | `null`                                       | `QueueItem {queueItem.ftQueueItemId} recovered Queue {queueAT.ftQueueATId} from used-moblie mode. Closing chain of mobile receipts from {fromReceipt} to {toReceipt}.`                                                                    |
| AT     | `null`                                       | `QueueItem {queueItem.ftQueueItemId} recovered Queue {queueAT.ftQueueATId} from used-failed mode. Closing chain of failed receipts from {fromReceipt} to {toReceipt}.`                                                                    |
| AT     | `null`                                       | `QueueItem {queueItem.ftQueueItemId} recovered Queue {queueAT.ftQueueATId} from SSCD-failed mode. Closing chain of failed receipts from {fromReceipt} to {toReceipt}.`                                                                    |
| IT     | `49542xxxxxxx2011`                           | `Daily-Closing receipt was processed.`                                                                                                                                                                                                    |
| IT     | `49542xxxxxxx2012`                           | `Monthly-Closing receipt was processed.`                                                                                                                                                                                                  |
| IT     | `4954200000004001-ActivateQueueSCU`          | `Initial-Operation receipt. Queue-ID: {queue.ftQueueId}`                                                                                                                                                                                  |
| IT     | `4954200000004001`                           | `Queue {queue.ftQueueId} is de-activated, initial-operations-receipt can not be executed.`                                                                                                                                                |
| IT     | `4954200000004001`                           | `Queue {queue.ftQueueId} is already activated, initial-operations-receipt can not be executed.`                                                                                                                                           |
| IT     | `4954200000004002-DeactivateQueueSCU`        | `Out-of-Operation receipt. Queue-ID: {queue.ftQueueId}`                                                                                                                                                                                   |
| IT     | `4954200000004002-Queue-already-deactivated` | `Out-of-Operation receipt. Queue-ID: {queue.ftQueueId}", $"Queue was already deactivated on the {queue.StopMoment.Value.ToString("yyyy-MM-dd hh:mm:ss")}`                                                                                 |
| IT     | `49542xxxxxxx2013`                           | `Yearly-Closing receipt was processed.`                                                                                                                                                                                                   |
| FR     | `null`                                       | `Archive requested`                                                                                                                                                                                                                       |
| FR     | `null`                                       | `Daily closure`                                                                                                                                                                                                                           |
| FR     | `null`                                       | `Monthly closure`                                                                                                                                                                                                                         |
| FR     | `null`                                       | `Shift closure`                                                                                                                                                                                                                           |
| FR     | `null`                                       | `QueueItem {queueItem.ftQueueItemId} start enable of Queue {queueFR.ftQueueFRId}`                                                                                                                                                         |
| FR     | `null`                                       | `QueueItem {queueItem.ftQueueItemId} try to disable Queue {queueFR.ftQueueFRId}`                                                                                                                                                          |
| FR     | `null`                                       | `Yearly closure`                                                                                                                                                                                                                          |
| FR     | `null`                                       | `Zero receipt`                                                                                                                                                                                                                            |
| FR     | `null`                                       | `QueueItem {queueItem.ftQueueItemId} error on resolving ftReceiptIdentification of queue item {queueFR.UsedFailedQueueItemId} where used-failed beginns: {x.Message}.`                                                                    |
| FR     | `null`                                       | `QueueItem {queueItem.ftQueueItemId} recovered Queue {queueFR.ftQueueFRId} from used-failed mode. closing chain of failed receipts from {fromReceipt} to {toReceipt}.`                                                                    |
| FR     | `null`                                       | `The received request contained errors.`                                                                                                                                                                                                  |
| FR     | `null`                                       | `QueueItem {queueItem.ftQueueItemId} enabled mode \"UsedFailed\" of Queue {queueFR.ftQueueFRId}`                                                                                                                                          |
| FR     | `null`                                       | `The charge item cases [0x{string.Join(", ", wrongChargeItems.Select(x => x.ftChargeItemCase.ToString("X")))}] do not match the expected country id 0x4652XXXXXXXXXXXX`                                                                   |
| FR     | `null`                                       | `The pay item case [0x{string.Join(", ", wrongPayItems.Select(x => x.ftPayItemCase.ToString("X")))}] does not match the expected country id 0x4652XXXXXXXXXXXX`                                                                           |
| FR     | `null`                                       | `The sum of the amounts of the charge items ({chargeItemSum}) is not equal to the sum of the amounts of the pay items ({payItemSum})`                                                                                                     |
| FR     | `null`                                       | `Queue {queueFR.ftQueueFRId} is out of order, it has not been activated!`                                                                                                                                                                 |
| FR     | `null`                                       | `Queue {queueFR.ftQueueFRId} is out of order, it is permanent de-activated!`                                                                                                                                                              |
| DE     | `4445000008000007`                           | `Daily-closing receipt was processed, and a master data update was performed. However TSE was not reachable.`                                                                                                                             |
| DE     | `4445000000000007`                           | `Daily-closing receipt was processed. However TSE was not reachable.`                                                                                                                                                                     |
| DE     | `4445000008000007`                           | `Monthly-closing receipt was processed, and a master data update was performed. However TSE was not reachable.`                                                                                                                           |
| DE     | `4445000000000007`                           | `Monthly-closing receipt was processed. However TSE was not reachable.`                                                                                                                                                                   |
| DE     | `4445000008000007`                           | `Yearly-closing receipt was processed, and a master data update was performed. However TSE was not reachable.`                                                                                                                            |
| DE     | `4445000000000007`                           | `Yearly-closing receipt was processed. However TSE was not reachable.`                                                                                                                                                                    |

## Run Acceptance Tests locally

### MySQL

`docker run --env=MYSQL_ROOT_PASSWORD=my-secret-pw -p 3306:3306 -d mysql:latest`

`Server=localhost;Port=3306;Uid=root;Pwd=my-secret-pw;`

### AzureTableStorage

`docker run -p 10002:10002 -p 10000:10000 -p 10001:10001 -d mcr.microsoft.com/azure-storage/azurite azurite --tableHost 0.0.0.0 --blobHost 0.0.0.0 --queueHost 0.0.0.0`

`DefaultEndpointsProtocol=http;AccountName=devstoreaccount1;AccountKey=Eby8vdM02xNOcqFlqUwJPLlmEtlCDXJ1OUzFT50uSRZ6IFsuFq2UVErCz4I6tq/K1SZFPTOtr/KBHBeksoGMGw==;BlobEndpoint=http://localhost:10000/devstoreaccount1;QueueEndpoint=http://localhost:10001/devstoreaccount1;TableEndpoint=http://localhost:10002/devstoreaccount1;`

### EF

`docker run --user=mssql --env=ACCEPT_EULA=Y --env=MSSQL_SA_PASSWORD=my-secret-PW-01 -p 1433:1433 -d mcr.microsoft.com/mssql/server:2022-latest`

`Server=localhost,1433;MultipleActiveResultSets=true;User ID=sa;Password=my-secret-PW-01`