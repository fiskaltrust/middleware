name: 'Deploy v2 Storage'

inputs:
  directory:
    required: true
    type: string
  package:
    required: true
    type: string
  storageAccountName:
    required: true
    type: string
  sas:
    required: true
    type: string

runs:
  using: "composite"
  steps:
    - name: Azure CLI script
      uses: azure/cli@v2
      with:
        azcliversion: latest
        inlineScript: |
          az storage blob upload-batch --account-name ${{ inputs.storageAccountName }} --auth-mode key -d "packages" --destination-path "undefined/${{ inputs.package }}/" -s "${{ inputs.directory }}" --pattern "*.zip*"
      env:
        AZURE_STORAGE_SAS_TOKEN: ${{ inputs.sas }}