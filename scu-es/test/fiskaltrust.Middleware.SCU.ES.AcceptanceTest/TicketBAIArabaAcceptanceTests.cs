using System;
using System.Security.Cryptography;
using System.Security.Cryptography.X509Certificates;
using fiskaltrust.ifPOS.v2.es;
using fiskaltrust.Middleware.SCU.ES.TicketBAI.Common;
using fiskaltrust.Middleware.SCU.ES.TicketBAIAraba;
using Microsoft.Extensions.Logging.Abstractions;
using Xunit;

namespace fiskaltrust.Middleware.SCU.ES.AcceptanceTest;

[Collection("TicketBAI Araba Tests")]
public class TicketBAIArabaAcceptanceTests : ESScuAcceptanceTestBase
{
    private readonly TicketBaiSCUConfiguration _configuration;

    public TicketBAIArabaAcceptanceTests()
    {
        var certificateBase64 = "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";
        var certificatePassword = "Iz3np32023";
        // Note: These are test/sandbox values. Update with real test certificates for actual testing
        _configuration = new TicketBaiSCUConfiguration
        {
            EmisorNif = "B10646545",
            EmisorApellidosNombreRazonSocial = "Test Company S.L.",
            SoftwareLicenciaTBAI = "TBAIARbKKFCFdCC00879",
            SoftwareNif = "B10646545",
            SoftwareName = "Incodebiz",
            SoftwareVersion = "1.0",
            Certificate = new X509Certificate2(Convert.FromBase64String(certificateBase64.ToString()!), certificatePassword.ToString()!)
        };
    }

    protected override IESSSCD CreateScu()
    {
        var logger = NullLogger<TicketBaiSCU>.Instance;
        var territory = new TicketBaiArabaTerritory();
        return new TicketBaiArabaSCU(logger, _configuration);
    }
}
