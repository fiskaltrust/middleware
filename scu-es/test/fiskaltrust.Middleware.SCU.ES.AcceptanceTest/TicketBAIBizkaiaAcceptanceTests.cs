using System;
using System.Security.Cryptography;
using System.Security.Cryptography.X509Certificates;
using fiskaltrust.ifPOS.v2.es;
using fiskaltrust.Middleware.SCU.ES.TicketBAI.Common;
using fiskaltrust.Middleware.SCU.ES.TicketBAIBizkaia;
using Microsoft.Extensions.Logging.Abstractions;
using Xunit;

namespace fiskaltrust.Middleware.SCU.ES.AcceptanceTest;

[Collection("TicketBAI Bizkaia Tests")]
public class TicketBAIBizkaiaAcceptanceTests : ESScuAcceptanceTestBase
{
    private readonly TicketBaiSCUConfiguration _configuration;

    public TicketBAIBizkaiaAcceptanceTests()
    {
        var certificateBase64 = "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\r\n";
        var certificatePassword = "123456";
        // Note: Certificate NIF extracted from ORGANIZATIONIDENTIFIER=VATES-S7836107H
        _configuration = new TicketBaiSCUConfiguration
        {
            EmisorNif = "S7836107H",
            EmisorApellidosNombreRazonSocial = "IZENPE S.A.",
            SoftwareLicenciaTBAI = "TBAIBI00000000PRUEBA",
            SoftwareNif = "A99800005",
            SoftwareName = "SOFTWARE GARANTE TICKETBAI PRUEBA",
            SoftwareVersion = "1.0.0",
            Certificate = new X509Certificate2(Convert.FromBase64String(certificateBase64.ToString()!), certificatePassword.ToString()!)
        };
    }

    protected override IESSSCD CreateScu()
    {
        var logger = NullLogger<TicketBaiSCU>. Instance;
        var territory = new TicketBaiBizkaiaTerritory();
        return new TicketBaiBizkaiaSCU(logger, _configuration);
    }
}
